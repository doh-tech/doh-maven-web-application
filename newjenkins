 def  buildNumber =  BUILD_NUMBER
 
 pipeline{
     agent any
     
     tools{
         maven "maven3.9.3"
     }
         
     
     
     stages{
     
         stage("Gitdownload"){
             steps{
                 git branch: 'development', credentialsId: '95783d07-8cdc-4a88-8c99-18767cfacc37', url: 'https://github.com/doh-tech/doh-maven-web-application.git'
         }
         }
         stage("Building The Code"){
             steps{
                 sh "mvn clean package"
         }
         }
         stage("Execute SonarGube report"){
             steps{
                 sh "mvn sonar:sonar"
         }
         }
         stage("Ofloadinf Artifact Into Nexus"){
             steps{
                 sh "mvn deploy"
         }
         }
         stage("Ofload To Nexus"){
             steps{
                 sh "mvn deploy"
         }
         }
         stage("Building Docker Image"){
             steps{
                 sh "docker build -t doh1/maven-web-app:${buildNumber} ."
         }
         }
         stage("Ofloading artifact into dockerhub"){
             steps{
                 withCredentials([string(credentialsId: '77c834a7-a7b0-4af7-be0e-5543c2630a71', variable: 'Docker_hub_Pwd')]) {
                 sh "docker login -u doh1 -p ${Docker_hub_Pwd}"
                }
                sh "docker push  doh1/maven-web-app:${buildNumber}" 
         }
         }
         stage("Deploying Into Target Server"){
             steps{
                        
         }
         }
         
     }//clossing stages
     }//clossing pipeline
 
